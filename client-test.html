<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Socket.io Test</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body style="font-family: sans-serif; padding: 20px;">
    <h2>Family Tracker Real-Time Test</h2>
    
    <div style="border: 1px solid #ccc; padding: 10px; margin-bottom: 20px;">
        <h3>Simulate Phone (Sender)</h3>
        <button onclick="sendLocation()">Send Random Location</button>
    </div>

    <div style="border: 1px solid #ccc; padding: 10px;">
        <h3>Parent View (Receiver)</h3>
        <ul id="updates"></ul>
    </div>

    <script>
        // 1. 拽  专 转 -ID ( 砖 拽 驻 专)
        const MY_USER_ID = '4e361274-853c-4158-a60a-a670e99b2c82'; 

        // 2. 转专 砖专转 砖 转 -ID 转 -query
        const socket = io('http://localhost:3000', {
            query: { userId: MY_USER_ID } // <--- 住驻 转 !
        });
        
        socket.on('connect', () => {
            console.log('Connected to server!');
            addLog('Connected to server via WebSocket!');
        });

        //  专注 砖专转 ( 砖专 专)
        socket.on('newLocationReceived', (data) => {
            console.log('Update received:', data);
            addLog(` New Location: User ${data.userId} is at [${data.latitude}, ${data.longitude}]`);
        });

        // 驻拽爪 砖 砖转 拽 驻
        function sendLocation() {
            const payload = {
                latitude: 32.08 + (Math.random() * 0.01),
                longitude: 34.78 + (Math.random() * 0.01),
                userId: MY_USER_ID
            };
            
            // 砖转 专注 砖专转
            socket.emit('updateLocation', payload);
        }

        function addLog(message) {
            const li = document.createElement('li');
            li.textContent = `${new Date().toLocaleTimeString()} - ${message}`;
            document.getElementById('updates').prepend(li);
        }
    </script>
</body>
</html>